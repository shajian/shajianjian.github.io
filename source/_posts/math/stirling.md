---
title: 斯特林数
date: 2024-12-26 14:13:19
tags: 组合数学
mathjax: true
---

# 1. 第一类斯特林数

第一类斯特林数 $s(n,k)$ 表示将n个不同元素构成k个 __圆排列__ 的方法数，也记为

$$s(n,k)=\begin{bmatrix}n \\\\ k\end{bmatrix}$$

1. $k=0, n > 0$ 时，$s(n,k)=0$

2. $n=k > 0$ 时，$s(n,k)=1$

3. 特别地，规定 $s(0,0)=1$

## 1.1 递归公式

3 个不同元素 $\{A,B,C\}$ 构成 1 个圆排列的方法数为 2，列举如下

```
[A,B,C], [A,C,B]
```

故 $s(3,1)=2$

类似地，$s(3,2)=3$，列举如下，

```
[A,B][C] [A,C][B] [B,C][A]
```

现在要计算 $s(4,2)$，显然有两种情况：

1. 前 3 个元素构成 1 个圆排列，第 4 个元素构成 1 个圆排列，对应的方法数为 $s(3,1)$

    ```
    [A,B,C][D] [A,C,B][D]
    ```

2. 前 3 个元素构成 2 个圆排列，第 4 个元素插入到其中一个圆排列中，对应的方法数为 $3 \times s(3,2)$

    ```sh
    # 插入位置1  插入位置2    插入位置3
    [A,D,B][C]  [A,B,D][C] [A,B][C,D]
    [A,D,C][B]  [A,C,D][B] [A,C][B,D]
    [B,D,C][A]  [B,C,D][A] [B,C][A,D]
    ```

    这里 $s(3,2)$ 的每一个方法中，均有 3 个位置可以插入，事实上，对于 $s(n,k)$ 的每一个方法中，插入一个新元素，均有 n 个位置可插入。

故 $s(4,2)=s(3,1) + 3 \times s(3,2)=11$

根据上述例子，不难得知

$$s(n+1,k+1)=s(n,k) + n \times s(n, k+1)$$

# 2. 第二类斯特林数

第二类斯特林数 $S(n,k)$ 表示将 n 个不同元素构成 k 个非空子集的方法数，也记为

$$S(n,k)=\begin{Bmatrix}n \\\\ k\end{Bmatrix}$$

1. $k=0,n > 0$ 时，$S(n,k)=0$

2. $n=k>0$ 时，$S(n,k)=1$

3. 特别地，规定 $S(0,0)=1$

举例说明：

1. $S(3,1)=1$

    ```
    {A,B,C}
    ```

2. $S(3,2)=3$

    ```
    {A,B}{C} {A,C}{B} {B,C}{A}
    ```

现在要计算 $S(4,2)$，考虑两种情况，

1. 前 3 个元素构成 1 个子集，第 4 个元素构成 1 个子集，方法数为 $S(3,1)$

    ```
    {A,B,C}{D}
    ```

2. 前 3 个元素构成 2 个子集，第 4 个元素插入到其中一个子集中

    ```
    {A,B,D}{C} {A,B}{C,D}
    {A,C,D}{B} {A,C}{B,D}
    {B,C,D}{A} {B,C}{A,D}
    ```
    每一种方法有 2 个子集，将第 4 个元素插入到 2 个子集中的一个，有两种插法，故一共 $2 \times S(3,2)$

故 $S(4,2)=S(3,1)+2\times S(3,2)$

## 2.1 递归公式

$$S(n+1,k+1)=S(n,k) + (k+1) \times S(n,k+1)$$